{% extends "base.html" %}

{% block title %}Dashboard Importações Resumido - Portal UniSystem{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('dash_importacoes_resumido.static', filename='dash_importacoes_resumido/dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="dashboard-resumido-container">
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Carregando dados...</p>
        </div>
    </div>

    <!-- Actions Bar with Breadcrumb -->
    <div class="actions-bar">
        <div class="actions-left">
            {{ breadcrumb([
                {'name': 'Menu', 'icon': 'mdi mdi-menu', 'url': url_for('menu.menu_home')},
                {'name': 'Dashboards', 'icon': 'mdi mdi-view-dashboard', 'url': url_for('menu.dashboards')},
                {'name': 'Dashboard Importações', 'icon': 'mdi mdi-ship'}
            ]) }}
        </div>
        <div class="actions-right">
            <button id="btn-fullscreen-tv" class="btn btn-secondary">
                <i class="mdi mdi-fullscreen"></i>
                Modo TV
            </button>
            <button id="btn-settings" class="btn btn-primary">
                <i class="mdi mdi-cog"></i>
                Configurações
            </button>
        </div>
    </div>

    <!-- Container Unificado Principal -->
    <div class="dashboard-main-content">
        <!-- Header com Métricas -->
        <div class="header-section">
            <div class="header-left">
                <div class="metrics-section">
                    <div class="total-info">
                        <span id="total-processos">TOTAL: 0 PROCESSOS</span>
                    </div>
                    <div class="modal-counts-container">
                        <div class="modal-count-item">
                            <img src="/static/medias/ship_color.png" alt="Marítimo" class="modal-count-icon">
                            <span id="count-maritimo">0</span>
                        </div>
                        <div class="modal-count-item">
                            <img src="/static/medias/plane_color.png" alt="Aéreo" class="modal-count-icon">
                            <span id="count-aereo">0</span>
                        </div>
                        <div class="modal-count-item">
                            <img src="/static/medias/truck_color.png" alt="Terrestre" class="modal-count-icon">
                            <span id="count-terrestre">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="header-center">
                <div class="company-logo">
                    <!-- Logo do cliente será exibida aqui dinamicamente -->
                    <img id="client-logo" src="{{ url_for('static', filename='medias/Logo_Unique.png') }}" alt="Logo Cliente" class="logo-img">
                </div>
            </div>
            
            <div class="header-right">
                <div class="time-info">
                    <!-- Primeira linha: USD + Relógio -->
                    <div class="time-row">
                        <div class="currency-item-small">
                            <span class="currency-symbol-small">$</span>
                            <span id="dolar-rate-top" class="currency-value-small">-.----</span>
                        </div>
                        <div class="current-time" id="current-time">--:--</div>
                    </div>
                    
                    <!-- Segunda linha: EUR + Data -->
                    <div class="time-row">
                        <div class="currency-item-small">
                            <span class="currency-symbol-small">€</span>
                            <span id="euro-rate-top" class="currency-value-small">-.----</span>
                        </div>
                        <div class="current-date" id="current-date">-- ------</div>
                    </div>
                    
                    <!-- Terceira linha: Indicador de Loop (apenas no modo TV) -->
                    <div class="time-row time-row-loop">
                        <div id="auto-loop-indicator-header" class="auto-loop-indicator-header">
                            <i class="mdi mdi-autorenew"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabela de Dados -->
        <div class="table-container">
            <table class="custom-table" id="data-table">
                <thead>
                    <tr>
                        <th>MODAL</th>
                        <th>NUM</th>
                        <th>NÚMERO DI</th>
                        <th>ORIGEM</th>
                        <th>REF IMPORTADOR</th>
                        <th>DATA EMBARQUE</th>
                        <th>DATA CHEGADA</th>
                        <th>DATA REGISTRO</th>
                        <th>CANAL</th>
                        <th>DATA ENTREGA</th>
                        <th>DESTINO</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- Dados serão inseridos via JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Paginação simplificada -->
        <div class="pagination-container">
            <div class="page-info-container">
                <span id="page-info" class="page-info">Página 1 de 1</span>
                <div id="auto-loop-indicator" class="auto-loop-indicator">
                    <i class="mdi mdi-autorenew"></i>
                    <span>Loop Automático Ativo</span>
                </div>
            </div>
        </div>

        <!-- Rodapé -->
        <div class="footer-section">
            <div class="footer-center">
                <div class="copyright">
                    <span>Copyright © 2024 Todos os direitos reservados.</span>
                    <img src="{{ url_for('static', filename='medias/Logo_Unique.png') }}" alt="Unique" class="footer-logo">
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Configurações -->
    <div id="settings-modal" class="settings-modal">
        <div class="settings-modal-content">
            <div class="settings-modal-header">
                <h2>
                    <i class="mdi mdi-cog"></i>
                    Configurações do Dashboard
                </h2>
                <button id="btn-close-settings" class="btn-close-settings">
                    <i class="mdi mdi-close"></i>
                </button>
            </div>
            
            <div class="settings-modal-body">
                <form id="settings-form">
                    <!-- Grade de Configurações -->
                    <div class="settings-grid">
                        
                        <!-- Card: Loop Automático -->
                        <div class="settings-card">
                            <div class="settings-card-header">
                                <i class="mdi mdi-autorenew"></i>
                                <h3>Loop Automático</h3>
                            </div>
                            <div class="settings-card-body">
                                <div class="settings-row">
                                    <label for="auto-loop-enabled" class="toggle-label">
                                        <input type="checkbox" id="auto-loop-enabled" checked>
                                        <span class="toggle-slider"></span>
                                        <span class="toggle-text">Ativar Loop</span>
                                    </label>
                                </div>
                                <div class="settings-row">
                                    <label for="auto-loop-interval">Intervalo (segundos):</label>
                                    <input type="number" id="auto-loop-interval" min="5" max="120" value="15" class="settings-input">
                                </div>
                                <div class="settings-row">
                                    <label for="auto-loop-pause-duration">Pausa após Interação:</label>
                                    <input type="number" id="auto-loop-pause-duration" min="5" max="60" value="10" class="settings-input">
                                </div>
                            </div>
                        </div>

                        <!-- Card: Atualização -->
                        <div class="settings-card">
                            <div class="settings-card-header">
                                <i class="mdi mdi-refresh"></i>
                                <h3>Atualização</h3>
                            </div>
                            <div class="settings-card-body">
                                <div class="settings-row">
                                    <label for="auto-refresh-enabled" class="toggle-label">
                                        <input type="checkbox" id="auto-refresh-enabled" checked>
                                        <span class="toggle-slider"></span>
                                        <span class="toggle-text">Auto Refresh</span>
                                    </label>
                                </div>
                                <div class="settings-row">
                                    <label for="auto-refresh-interval">Intervalo (segundos):</label>
                                    <input type="number" id="auto-refresh-interval" min="10" max="300" value="30" class="settings-input">
                                </div>
                                <div class="settings-row">
                                    <button id="btn-manual-refresh" type="button" class="btn btn-secondary btn-full">
                                        <i class="mdi mdi-refresh"></i>
                                        Atualizar Agora
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Card: Exibição -->
                        <div class="settings-card">
                            <div class="settings-card-header">
                                <i class="mdi mdi-table"></i>
                                <h3>Exibição</h3>
                            </div>
                            <div class="settings-card-body">
                                <div class="settings-row">
                                    <label for="records-per-page">Registros por página:</label>
                                    <select id="records-per-page" class="settings-select">
                                        <option value="5">5 registros</option>
                                        <option value="10" selected>10 registros</option>
                                        <option value="15">15 registros</option>
                                        <option value="20">20 registros</option>
                                        <option value="25">25 registros</option>
                                    </select>
                                </div>
                                <div class="settings-row">
                                    <label for="compact-mode" class="toggle-label">
                                        <input type="checkbox" id="compact-mode">
                                        <span class="toggle-slider"></span>
                                        <span class="toggle-text">Modo Compacto</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Card: Filtros -->
                        <div class="settings-card">
                            <div class="settings-card-header">
                                <i class="mdi mdi-filter"></i>
                                <h3>Filtros</h3>
                            </div>
                            <div class="settings-card-body">
                                <div class="settings-row">
                                    <label for="filter-embarque-default" class="toggle-label">
                                        <input type="checkbox" id="filter-embarque-default">
                                        <span class="toggle-slider"></span>
                                        <span class="toggle-text">Data de Embarque</span>
                                    </label>
                                </div>
                                <div class="settings-row">
                                    <button id="btn-apply-filter" type="button" class="btn btn-secondary btn-full">
                                        <i class="mdi mdi-filter-check"></i>
                                        Aplicar Filtros
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Card: Interface -->
                        <div class="settings-card">
                            <div class="settings-card-header">
                                <i class="mdi mdi-palette"></i>
                                <h3>Interface</h3>
                            </div>
                            <div class="settings-card-body">
                                <div class="settings-row">
                                    <label for="theme-mode">Tema:</label>
                                    <select id="theme-mode" class="settings-select">
                                        <option value="auto" selected>Automático</option>
                                        <option value="light">Claro</option>
                                        <option value="dark">Escuro</option>
                                    </select>
                                </div>
                                <div class="settings-row">
                                    <label for="animations-enabled" class="toggle-label">
                                        <input type="checkbox" id="animations-enabled" checked>
                                        <span class="toggle-slider"></span>
                                        <span class="toggle-text">Animações</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Card: Controles -->
                        <div class="settings-card">
                            <div class="settings-card-header">
                                <i class="mdi mdi-play-pause"></i>
                                <h3>Controles</h3>
                            </div>
                            <div class="settings-card-body">
                                <div class="settings-row">
                                    <button id="btn-toggle-loop" type="button" class="btn btn-secondary btn-full">
                                        <i id="loop-control-icon" class="mdi mdi-pause"></i>
                                        <span id="loop-control-text">Parar Loop</span>
                                    </button>
                                </div>
                                <div class="settings-row">
                                    <button id="btn-reset-settings" type="button" class="btn btn-warning btn-full">
                                        <i class="mdi mdi-restore"></i>
                                        Restaurar Padrões
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>
                </form>
            </div>
            
            <div class="settings-modal-footer">
                <div class="settings-footer-left">
                    <span class="settings-status">Configurações salvas automaticamente</span>
                </div>
                <div class="settings-footer-actions">
                    <button id="btn-cancel-settings" class="btn btn-secondary">
                        <i class="mdi mdi-close"></i>
                        Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('dash_importacoes_resumido.static', filename='dash_importacoes_resumido/dashboard.js') }}"></script>
{% endblock %}
